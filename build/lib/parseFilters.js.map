{"version":3,"sources":["../../src/lib/parseFilters.js"],"names":["eventRX","RegExp","invalidRX","parseRaw","content","input","replace","event","name","escape","eventText","text","parsePost","data","postData","parsePostCallback","cb","asCallback","parseRawCallback"],"mappings":";;;;;;;;;AAAA;;;;AACA;;AACA;;;;;;AAEA,MAAMA,UAAU,IAAIC,MAAJ,CAAW,wBAAY,OAAZ,EAAqB,WAArB,CAAX,CAAhB;AACA,MAAMC,YAAY,IAAID,MAAJ,CAAY,IAAG,wBAAY,eAAZ,EAA6B,WAA7B,CAA0C,GAAzD,CAAlB;;AAEA,MAAME;AAAA,sCAAW,WAAOC,OAAP,EAAmB;AAClC,UAAMC,QAAQD,QAAQE,OAAR,CACZ,2CADY,EAEZ,sCAFY,CAAd;AAIA,UAAMC,QAAQ,qBAAMF,KAAN,CAAd;AACA,QAAI,CAACE,KAAL,EAAY;AACV,aAAOF,MAAMC,OAAN,CAAcJ,SAAd,EAAyB,4BAAzB,CAAP;AACD;AACDK,UAAMC,IAAN,GAAa,oBAAUC,MAAV,CAAiBF,MAAMC,IAAvB,CAAb;;AAEA,UAAME,YAAY,8BAAc,EAAEH,YAAF,EAAd,CAAlB;AACA,UAAMI,OAAON,MAAMC,OAAN,CAAcN,OAAd,EAAuBU,SAAvB,CAAb;AACA,WAAOC,IAAP;AACD,GAdK;;AAAA;AAAA;AAAA;AAAA,IAAN;;AAgBA,MAAMC;AAAA,uCAAY,WAAOC,IAAP,EAAgB;AAChC,UAAMC,WAAWD,KAAKC,QAAtB;AACAA,aAASV,OAAT,GAAmB,MAAMD,SAASW,SAASV,OAAlB,CAAzB;;AAEA,WAAOS,IAAP;AACD,GALK;;AAAA;AAAA;AAAA;AAAA,IAAN;;AAOA,MAAME,oBAAoB,CAACD,QAAD,EAAWE,EAAX,KAAkBJ,UAAUE,QAAV,EAAoBG,UAApB,CAA+BD,EAA/B,CAA5C;AACA,MAAME,mBAAmB,CAACd,OAAD,EAAUY,EAAV,KAAiBb,SAASC,OAAT,EAAkBa,UAAlB,CAA6BD,EAA7B,CAA1C;;QAESD,iB,GAAAA,iB;QAAmBH,S,GAAAA,S;QAAWM,gB,GAAAA,gB;QAAkBf,Q,GAAAA,Q","file":"parseFilters.js","sourcesContent":["import validator from 'validator';\r\nimport { eventTemplate } from './templates';\r\nimport parse, { tagTemplate } from './parse';\r\n\r\nconst eventRX = new RegExp(tagTemplate('event', '[\\\\s\\\\S]*'));\r\nconst invalidRX = new RegExp(`(${tagTemplate('event-invalid', '[\\\\s\\\\S]*')})`);\r\n\r\nconst parseRaw = async (content) => {\r\n  const input = content.replace(\r\n    /\\[description\\]([\\s\\S]*)\\[\\/description\\]/,\r\n    '[description]<p>$1</p>[/description]'\r\n  );\r\n  const event = parse(input);\r\n  if (!event) {\r\n    return input.replace(invalidRX, '<div class=\"hide\">$1</div>');\r\n  }\r\n  event.name = validator.escape(event.name);\r\n\r\n  const eventText = eventTemplate({ event });\r\n  const text = input.replace(eventRX, eventText);\r\n  return text;\r\n};\r\n\r\nconst parsePost = async (data) => {\r\n  const postData = data.postData;\r\n  postData.content = await parseRaw(postData.content);\r\n\r\n  return data;\r\n};\r\n\r\nconst parsePostCallback = (postData, cb) => parsePost(postData).asCallback(cb);\r\nconst parseRawCallback = (content, cb) => parseRaw(content).asCallback(cb);\r\n\r\nexport { parsePostCallback, parsePost, parseRawCallback, parseRaw };\r\n"]}